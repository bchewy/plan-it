import{a as u}from"./axios-21b846bc.js";import{_ as f,o as d,c as l,a as r,q as R,x as b,F as E,f as I,t as h,d as g,y as P,u as $,e as q,j as F}from"./index-0fdca0a9.js";import{l as a}from"./index-f203fe86.js";/* empty css              */const N={props:["user"],setup(){return{}},data(){return{friendEmail:"",errorMessage:"",successMessage:"",searchResults:[]}},methods:{async sendFriendRequest(){if(!this.user.sub){this.errorMessage="User prop wasn't passed properly.";return}try{const e=await u.post(`${{}.VITE_API_ENDPOINT}/users/${this.user.email}/friend_requests/send`,{friend_email:this.friendEmail},{headers:{"Content-Type":"application/json","x-api-key":`${{}.VITE_API_KEY}`},validateStatus:function(s){return s>=200&&s<500}});e.status===200?(this.successMessage="Friend request sent successfully.",a.success("Friend request sent successfully.",{autoClose:5e3,position:a.POSITION.TOP_CENTER}),this.$emit("friendRequestSent")):e.status===400?(this.errorMessage="Friend request already sent.",a.error("Friend request already sent!.",{autoClose:5e3,position:a.POSITION.TOP_CENTER})):e.status===404&&(this.errorMessage="Friend not found.",a.error("Friend not found.",{autoClose:5e3,position:a.POSITION.TOP_CENTER}))}catch{this.errorMessage="Please try again later. The backend may be down.",a.error("Please try again later. The backend may be down.",{autoClose:5e3,position:a.POSITION.TOP_CENTER})}this.searchResults=[]},async searchFriends(){try{const e=await u.get(`${{}.VITE_API_ENDPOINT}/users/search/${this.friendEmail}`,{headers:{"Content-Type":"application/json","x-api-key":`${{}.VITE_API_KEY}`}});this.searchResults=e.data}catch(e){console.error(e)}},selectFriend(e){this.friendEmail=e.email,this.searchResults=[]}}},v={class:"form-group mb-2 me-md-2 flex-grow-1"},w=r("label",{for:"friendEmail",class:"sr-only"},"Friend's Email:",-1),C={key:0,class:"dropdown-menu show"},O=["onClick"],x=r("button",{type:"submit",class:"btn btn-primary mb-2 flex-shrink-0"},"Send Friend Request",-1);function A(e,s,n,o,c,i){return d(),l("div",null,[r("form",{onSubmit:s[2]||(s[2]=P((...t)=>i.sendFriendRequest&&i.sendFriendRequest(...t),["prevent"])),class:"d-flex flex-column flex-md-row align-items-start align-items-md-center"},[r("div",v,[w,R(r("input",{id:"friendEmail","onUpdate:modelValue":s[0]||(s[0]=t=>c.friendEmail=t),type:"email",class:"form-control",required:"",placeholder:"Friend's Email",onInput:s[1]||(s[1]=(...t)=>i.searchFriends&&i.searchFriends(...t))},null,544),[[b,c.friendEmail]]),c.searchResults.length?(d(),l("div",C,[(d(!0),l(E,null,I(c.searchResults,t=>(d(),l("a",{class:"dropdown-item",onClick:m=>i.selectFriend(t)},h(t.email),9,O))),256))])):g("",!0)]),x],32)])}const te=f(N,[["render",A]]),k={props:["friend","user","receivedRequests","sentRequests","type"],data(){return{showAlert:!1,alertMessage:""}},computed:{showButtons(){return this.type==="received"}},methods:{async acceptRequest(){try{const e=this.user.email,s=`${{}.VITE_API_ENDPOINT}/users/${encodeURIComponent(e)}/friend_requests/accept`,n={friend_email:this.friend},o={"Content-Type":"application/json","x-api-key":`${{}.VITE_API_KEY}`},c=await u.post(s,n,{headers:o});this.showAlert=!0,this.alertMessage="Friend request accepted.",a.success("Friend Request successfully accepted.",{autoClose:5e3,position:a.POSITION.TOP_CENTER}),this.$emit("refresh")}catch(e){console.error("Error accepting friend request",e)}},async declineRequest(){try{const e=this.user.email,s=`${{}.VITE_API_ENDPOINT}/users/${encodeURIComponent(e)}/friend_requests/decline`,n={friend_email:this.friend},o={"Content-Type":"application/json","x-api-key":`${{}.VITE_API_KEY}`},c=await u.post(s,n,{headers:o});this.showAlert=!0,this.alertMessage="Friend request declined.",a("Friend Request successfully declined.",{autoClose:5e3,position:a.POSITION.TOP_CENTER}),this.$emit("refresh")}catch(e){console.error("Error declining friend request",e)}}}},M={class:"card mb-3"},V={class:"card-body"},D={class:"card-title"},S={key:0,class:"d-flex justify-content-end"};function B(e,s,n,o,c,i){return d(),l("div",M,[r("div",V,[r("h5",D,h(n.friend),1),i.showButtons?(d(),l("div",S,[r("button",{class:"btn btn-success me-2",onClick:s[0]||(s[0]=(...t)=>i.acceptRequest&&i.acceptRequest(...t))},"Accept"),r("button",{class:"btn btn-danger",onClick:s[1]||(s[1]=(...t)=>i.declineRequest&&i.declineRequest(...t))},"Decline")])):g("",!0)])])}const re=f(k,[["render",B]]),j={setup(){const{user:e,isAuthenticated:s}=$(),n=q([]),o={"x-api-key":`${{}.VITE_API_KEY}`},c=async()=>{const t=`${{}.VITE_API_ENDPOINT}/users/${encodeURIComponent(e.value.email)}/badges`;try{const m=await u.get(t,{headers:o});n.value=m.data;for(let p=0;p<n.value.length;p++){const y=n.value[p],T=`${{}.VITE_API_ENDPOINT}/badges/${y}`,_=await u.get(T,{headers:o});n.value[p]={id:y,badgesimg:_.data.image,name:_.data.name,description:_.data.description,milestone:_.data.milestone}}}catch(m){console.error("Error fetching badges",m)}};return F(async()=>{await c()}),{user:e,isAuthenticated:s,badges:n}}},U={class:"container"},K=r("div",{class:"row"},[r("div",{class:"col-12 text-center mt-5"},[r("h1",null,"My Badges")])],-1),Y={class:"row justify-content-center mt-5"},L={class:"card mb-3"},z=["src"],G={class:"card-body"},H={class:"card-title"},J={class:"card-text"},Q={class:"card-text"};function W(e,s,n,o,c,i){return d(),l("div",U,[K,r("div",Y,[(d(!0),l(E,null,I(o.badges,t=>(d(),l("div",{class:"col-12 col-md-6 col-lg-4",key:t.id},[r("div",L,[r("img",{src:t.badgesimg,class:"card-img-top",alt:"..."},null,8,z),r("div",G,[r("h5",H,h(t.name),1),r("p",J,h(t.description),1),r("p",Q,"Milestone: "+h(t.milestone),1)])])]))),128))])])}const ne=f(j,[["render",W]]);export{te as A,ne as B,re as F};
