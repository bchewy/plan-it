import{_ as k,a2 as I,r as b,o as h,c as _,a as e,b as n,w as c,y as N,t as E,d as T,i as o,u as P,e as m,bs as A,p as C,h as $}from"./index-0fdca0a9.js";import{a as y}from"./axios-21b846bc.js";const B=I({name:"NavBar",setup(){const{loginWithRedirect:t,user:i,isAuthenticated:v,logout:w}=P(),f=m(""),u=m(!1),s=m({}),p=()=>{g(),u.value=!u.value};A(i,async a=>{if(a)try{let r={auth0_user_id:a.sub,email:a.email,handle:a.nickname,pictureurl:a.picture};const d=await y.get(`${{}.VITE_API_ENDPOINT}/users/ez/${encodeURIComponent(a.email)}`,{headers:{"x-api-key":`${{}.VITE_API_KEY}`}}),_e=await d.data;if(console.log(d.data),d.status===200){console.log("User not found in the database"),r.exp=0,r.level=0,r.total_km=0;const x=await(await fetch(`${{}.VITE_API_ENDPOINT}/users`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":`${{}.VITE_API_KEY}`},body:JSON.stringify(r)})).json();console.log("User upserted:",x)}else console.log("User found in the database")}catch(r){console.error("Failed to upsert user on the Backend:",r)}});const g=async()=>{const a=`${{}.VITE_API_ENDPOINT}/users/iz/${encodeURIComponent(i.value.email)}`,r={"x-api-key":`${{}.VITE_API_KEY}`};try{const d=await y.get(a,{headers:r});s.value=d.data}catch(d){console.error("Error fetching user",d)}};return{login:async()=>{try{await t({appState:{targetUrl:window.location.pathname}})}catch(a){console.error("Failed to login:",a)}},logout:()=>{w({logoutParams:{returnTo:window.location.origin}})},user:i,isAuthenticated:v,userHandle:f,showGamification:u,toggleGamification:p,fetchUser:g,userMe:s}}}),l=t=>(C("data-v-3ee925e6"),t=t(),$(),t),z={class:"navbar navbar-expand-lg navbar-light bg-green"},S={class:"container"},V=l(()=>e("a",{class:"navbar-brand text-supergreen",href:"#"},[e("img",{src:"https://bchewy-images.s3.ap-southeast-1.amazonaws.com/plan-it/bchewy+conscious+travel+mascot.png",class:"img-fluid",style:{"max-height":"40px"}}),o(" Plan-It ")],-1)),U=l(()=>e("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},[e("span",{class:"navbar-toggler-icon"})],-1)),D={class:"collapse navbar-collapse",id:"navbarNav"},M={class:"navbar-nav me-auto"},O={class:"nav-item"},L={class:"nav-item"},R={class:"nav-item"},K={class:"nav-item"},Y={class:"nav-item"},j={class:"navbar-nav"},F={key:0,class:"nav-item"},G={key:1,class:"nav-item dropdown"},H={class:"nav-link dropdown-toggle text-evenlighter d-flex align-items-center",href:"#",id:"navbarDropdown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},W=["src"],q={class:"text-evenlighter"},J={class:"dropdown-menu bg-green2 text-evenlighter","aria-labelledby":"navbarDropdown"},Q={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",style:{fill:"rgba(255, 255, 255, 1)",transform:""}},X=l(()=>e("path",{d:"M12 2C6.579 2 2 6.579 2 12s4.579 10 10 10 10-4.579 10-10S17.421 2 12 2zm0 5c1.727 0 3 1.272 3 3s-1.273 3-3 3c-1.726 0-3-1.272-3-3s1.274-3 3-3zm-5.106 9.772c.897-1.32 2.393-2.2 4.106-2.2h2c1.714 0 3.209.88 4.106 2.2C15.828 18.14 14.015 19 12 19s-3.828-.86-5.106-2.228z"},null,-1)),Z=[X],ee={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",style:{fill:"rgba(255, 255, 255, 1)",transform:""}},te=l(()=>e("circle",{cx:"13",cy:"4",r:"2"},null,-1)),se=l(()=>e("path",{d:"M13.978 12.27c.245.368.611.647 1.031.787l2.675.892.633-1.896-2.675-.892-1.663-2.495a2.016 2.016 0 0 0-.769-.679l-1.434-.717a1.989 1.989 0 0 0-1.378-.149l-3.193.797a2.002 2.002 0 0 0-1.306 1.046l-1.794 3.589 1.789.895 1.794-3.589 2.223-.556-1.804 8.346-3.674 2.527 1.133 1.648 3.675-2.528c.421-.29.713-.725.82-1.225l.517-2.388 2.517 1.888.925 4.625 1.961-.393-.925-4.627a2 2 0 0 0-.762-1.206l-2.171-1.628.647-3.885 1.208 1.813z"},null,-1)),ae=[te,se],oe={key:0},ne={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",style:{fill:"rgb(255, 255, 255)",transform:""}},le=l(()=>e("path",{d:"m2.344 15.271 2 3.46a1 1 0 0 0 1.366.365l1.396-.806c.58.457 1.221.832 1.895 1.112V21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1.598a8.094 8.094 0 0 0 1.895-1.112l1.396.806c.477.275 1.091.11 1.366-.365l2-3.46a1.004 1.004 0 0 0-.365-1.366l-1.372-.793a7.683 7.683 0 0 0-.002-2.224l1.372-.793c.476-.275.641-.89.365-1.366l-2-3.46a1 1 0 0 0-1.366-.365l-1.396.806A8.034 8.034 0 0 0 15 4.598V3a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v1.598A8.094 8.094 0 0 0 7.105 5.71L5.71 4.904a.999.999 0 0 0-1.366.365l-2 3.46a1.004 1.004 0 0 0 .365 1.366l1.372.793a7.683 7.683 0 0 0 0 2.224l-1.372.793c-.476.275-.641.89-.365 1.366zM12 8c2.206 0 4 1.794 4 4s-1.794 4-4 4-4-1.794-4-4 1.794-4 4-4z"},null,-1)),ie=[le],re=l(()=>e("li",null,null,-1)),ce=l(()=>e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),de=l(()=>e("div",{class:"overlay bg-white",style:{height:"20px"}},null,-1));function he(t,i,v,w,f,u){const s=b("router-link"),p=b("font-awesome-icon");return h(),_("nav",z,[e("div",S,[V,U,e("div",D,[e("ul",M,[e("li",O,[n(s,{class:"nav-link text-evenlighter",to:"/"},{default:c(()=>[o("Home")]),_:1})]),e("li",L,[n(s,{class:"nav-link text-evenlighter",to:"/about"},{default:c(()=>[o(" About ")]),_:1})]),e("li",R,[n(s,{class:"nav-link text-evenlighter",to:"/route"},{default:c(()=>[o("Routing")]),_:1})]),e("li",K,[n(s,{class:"nav-link text-evenlighter",to:"/community"},{default:c(()=>[o(" Community ")]),_:1})]),e("li",Y,[n(s,{class:"nav-link text-evenlighter",to:"/leaderboard"},{default:c(()=>[o(" Leaderboards ")]),_:1})])]),e("ul",j,[t.isAuthenticated?(h(),_("li",G,[e("a",H,[e("img",{src:t.user.picture,alt:"",class:"rounded-circle me-2",style:{width:"30px",height:"30px"}},null,8,W),e("span",q,"Welcome, "+E(t.user.name)+"!",1)]),e("ul",J,[e("li",null,[n(s,{class:"dropdown-item text-light",to:"/profile"},{default:c(()=>[(h(),_("svg",Q,Z)),o(" Profile")]),_:1})]),e("li",null,[n(s,{class:"dropdown-item text-light",to:"/verify"},{default:c(()=>[(h(),_("svg",ee,ae)),o(" Verify")]),_:1})]),t.user.email=="brian@bchewy.com"||t.user.email=="melody.wong.2022@smu.edu.sg"||t.user.email=="ryanlee99324@gmail.com"||t.user.email=="planituser27@gmail.com"?(h(),_("li",oe,[n(s,{class:"dropdown-item text-light",to:"/admin"},{default:c(()=>[(h(),_("svg",ne,ie)),o(" Admin")]),_:1})])):T("",!0),re,ce,e("li",null,[e("a",{class:"dropdown-item text-light",onClick:i[1]||(i[1]=(...g)=>t.logout&&t.logout(...g))},[o("Logout "),n(p,{icon:"fa-solid fa-arrow-right-from-bracket"})])])])])):(h(),_("li",F,[e("a",{class:"nav-link text-evenlighter",onClick:i[0]||(i[0]=N((...g)=>t.login&&t.login(...g),["prevent"]))},"Login")]))])])]),de])}const me=k(B,[["render",he],["__scopeId","data-v-3ee925e6"]]);export{me as N};
