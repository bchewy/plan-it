import{M as y}from"./MapItem-e4c4c7f6.js";import{A as f}from"./AddFriends-a37c6021.js";import{N as C,a as h}from"./Navbar-2917e1de.js";import{C as g,r as x,F as I,B as k}from"./chartjs-adapter-date-fns.esm-2d0c330f.js";import{_ as P,u as w,e as m,r as E,o as l,c as d,b as R,a as t,F as _,f as B,t as u,p as M,j as T}from"./index-751a66e8.js";import"./auto-25ed8786.js";g.register(...x);const F={created(){this.fetchData()},watch:{activeTab:{immediate:!0,handler(e,a){e==="routes"&&this.$nextTick(()=>{this.fetchData()})}}},data(){const{user:e,isAuthenticated:a}=w(),s=m(0),r=m(0),n=m(0);return{users:[],userExp:s,expToNextLevel:r,userLvl:n,activeTab:"profile",isLoading:!1,currentPage:1,itemsPerPage:3,user:e,isAuthenticated:a,routes:[],friends:[],friendRequests:[],receivedRequests:[],sentRequests:[]}},computed:{paginatedRoutes(){const e=(this.currentPage-1)*this.itemsPerPage,a=e+this.itemsPerPage;return this.routes.slice(e,a)},totalPages(){return Math.ceil(this.routes.length/this.itemsPerPage)}},components:{Navbar:C,MapItem:y,AddFriend:f,FriendRequest:I,Badges:k},methods:{async drawChart(){if(!Array.isArray(this.routes)||this.routes.length===0){console.error("No routes available.");return}this.routes.sort((r,n)=>new Date(r.timestamp)-new Date(n.timestamp));const e=this.routes.map(r=>new Date(r.timestamp).toISOString()),a=this.routes.map(r=>parseFloat(r.carbon_emission.toFixed(1)));if(document.getElementById("carbonFootprintChart")){const r=document.getElementById("carbonFootprintChart").getContext("2d");this.myChart&&this.myChart.destroy(),console.log("Labels:",e),console.log("Count of Labels:",e.length),console.log("Data:",a),console.log("Count of Data:",a.length),console.log("Fake Data",[2,4,3]),console.log("Fake Labels",["2023-10-26T00:00:00.000Z","2023-10-27T00:00:00.000Z","2023-10-28T00:00:00.000Z"]),this.myChart=new g(r,{type:"bar",data:{labels:e,datasets:[{label:"Carbon Emission",data:a,backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1,scales:{x:{type:"time",time:{unit:"day",displayFormats:{day:"mmm d"}},bounds:"data",ticks:{source:"data",autoSkip:!0,minUnit:"day"}},y:{min:0,suggestedMax:5,ticks:{stepSize:.5}}}}});const n=this.routes.map(c=>c.transport_mode),i={};n.forEach(c=>{i[c]?i[c]++:i[c]=1});const p=Object.keys(i),o=Object.values(i);if(document.getElementById("travelCategoryChart")){const c=document.getElementById("travelCategoryChart").getContext("2d");this.myTravelModeChart&&this.myTravelModeChart.destroy(),this.myTravelModeChart=new g(c,{type:"pie",data:{labels:p,datasets:[{data:o,backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:2}})}}},fetchData(){this.fetchUsers()},async fetchUser(){const e=`https://api.bchwy.com/users/iz/${encodeURIComponent(this.user.email)}`,a={"x-api-key":"PlanItIsTheBestProjectEverXYZ"};try{const s=await h.get(e,{headers:a});this.friends=s.data.friends,this.userLvl=s.data.level,this.userExp=s.data.exp}catch(s){console.error("Error fetching user",s)}},async fetchFriendRequests(){const e=`https://api.bchwy.com/users/${encodeURIComponent(this.user.email)}/friend_requests`,a={"x-api-key":"PlanItIsTheBestProjectEverXYZ"};try{const s=await h.get(e,{headers:a});this.receivedRequests=s.data.received,this.sentRequests=s.data.sent}catch(s){console.error("Error fetching friend requests",s)}},async fetchRoutes(){const e=this.user.email,a=`https://api.bchwy.com/routes/email?email=${encodeURIComponent(e)}`,s={"x-api-key":"PlanItIsTheBestProjectEverXYZ"};try{const r=await h.get(a,{headers:s});this.routes=r.data.reverse()}catch(r){console.error("Error fetching routes:",r)}},async fetchUsers(){const e="https://api.bchwy.com/users",a={"x-api-key":"PlanItIsTheBestProjectEverXYZ"};try{const s=await h.get(e,{headers:a});this.users=s.data,console.log("test")}catch(s){console.error("Error fetching users:",s)}}}},b=e=>(M("data-v-7bb7e40f"),e=e(),T(),e),L={class:"container-fluid pt-3 bg-supergreen pb-3"},D={class:"row"},$={class:"col-lg-12"},N={class:"card"},q=b(()=>t("div",{class:"card-header"},[t("h4",{class:"card-title"},"Leaderboard")],-1)),S={class:"card-body"},U={class:"table-responsive"},j={class:"table table-striped"},A=b(()=>t("thead",null,[t("tr",null,[t("th",null,"Rank"),t("th",null,"Name"),t("th",null,"Level"),t("th",null,"CO2 Saved")])],-1)),Z=["src"],O=b(()=>t("br",null,null,-1)),X={key:0},Y={key:1};function V(e,a,s,r,n,i){const p=E("Navbar");return l(),d(_,null,[R(p),t("div",L,[t("div",D,[t("div",$,[t("div",N,[q,t("div",S,[t("div",U,[t("table",j,[A,t("tbody",null,[(l(!0),d(_,null,B(n.users,(o,v)=>(l(),d("tr",{key:o.email},[t("td",null,u(v+1),1),t("td",null,[t("img",{src:o.pictureurl,alt:"User Image",width:"50",height:"50"},null,8,Z),O,t("span",null,u(o.handle),1)]),t("td",null,u(o.level),1),o.carbonsavings?(l(),d("td",X,u(o.carbonsavings)+" Co2 kg",1)):(l(),d("td",Y))]))),128))])])])])])])])])],64)}const Q=P(F,[["render",V],["__scopeId","data-v-7bb7e40f"]]);export{Q as default};
