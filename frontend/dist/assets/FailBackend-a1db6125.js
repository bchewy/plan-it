import{s as C}from"./PostComponent-298e32a5.js";import{_ as $,a2 as P,r as g,o as r,c,a as s,b as u,i as m,F as p,f,n as E,t as y,q as v,bn as I,v as k,u as w,g as O}from"./index-0fdca0a9.js";import{a as h}from"./axios-21b846bc.js";const T=P({setup(){const{loginWithRedirect:t,user:e,isAuthenticated:o}=w();return{login:async()=>{console.log("Login button clicked");try{await t()}catch(a){alert("Failed to login"),console.error("Failed to login:",a)}},user:e,isAuthenticated:o}},name:"CreatePostComponent",components:{Editor:C},data(){return{badges:!1,friends:!1,content:"",badge:"",taggedfriends:[],likes:[],postStatus:!1,thisuser:"",userFriends:[],userBadges:[]}},async created(){if(!this.user.email)return;const t=`${{}.VITE_API_ENDPOINT}/users/iz/${encodeURIComponent(this.user.email)}`,e={"x-api-key":`${{}.VITE_API_KEY}`};try{const o=await h.get(t,{headers:e});this.thisuser=o.data;for(let a of o.data.badges){const i=`${{}.VITE_API_ENDPOINT}/badges/${a}`;try{const n=await h.get(i,{headers:e});this.userBadges.push({id:a,image:n.data.image,name:n.data.name,description:n.data.description})}catch(n){console.error("error",n)}}for(let a of o.data.friends){const i=`${{}.VITE_API_ENDPOINT}/users/iz/${encodeURIComponent(a)}`;try{const n=await h.get(i,{headers:e});this.userFriends.push({handle:"@"+n.data.handle})}catch(n){console.error("error",n)}}}catch(o){console.error("Error fetching user",o)}},methods:{parseParams(t){const e=Object.keys(t);let o="";return e.forEach(a=>{const i=typeof t[a]=="object",n=i&&t[a].length>=0;i||(o+=`${a}=${t[a]}&`),i&&n&&t[a].forEach(b=>{o+=`${a}=${b}&`})}),o&&o.slice(0,-1)},async createPost(t,e,o){console.log("content"),console.log(this.content);const a=`${{}.VITE_API_ENDPOINT}/users/${encodeURIComponent(t)}/posts`,i={"Content-Type":"application/json","x-api-key":`${{}.VITE_API_KEY}`},n=this.content,b={userprofile:o,username:e,useremail:t,content:n,badge:this.badge,taggedfriends:this.taggedfriends,likes:this.likes};h.post(a,{params:b},{headers:i}).then(l=>{console.log("response data here"),console.log(l.data),l.data.message=="Post created successfully."&&(this.postStatus=!0,this.content=""),this.$emit("postCreated")}).catch(l=>{console.error("Error:",l)})}}}),V={class:"row justify-content-center mt-4"},D={class:"col-10 rounded border bg-white px-4"},N=s("p",{class:"mt-3 text-muted"},"Â  Share something with the community!",-1),F={class:"row mb-3 justify-content-between"},B=s("span",{class:"col-1"},null,-1),L={class:"btn btn-secondary col-3",type:"button","data-bs-target":"#badgesOverlay","data-bs-toggle":"modal"},S={class:"modal fade",id:"badgesOverlay",tabindex:"-1","aria-labelledby":"badgesOverlayLabel","aria-hidden":"true"},A={class:"modal-dialog"},R={class:"modal-content"},U=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"BadgesModalLabel"},"Your Badges"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),j={class:"modal-body"},x={class:"list-unstyled"},M={class:"row"},Y=["src"],z={class:"card-body"},q={class:"card-title fw-bold text-center"},K={class:"col align-items-center d-flex"},W=["value"],G={class:"modal-footer"},H=s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},"Confirm",-1),J={class:"btn btn-secondary col-3",type:"button","data-bs-target":"#friendsOverlay","data-bs-toggle":"modal"},Q={class:"modal fade",id:"friendsOverlay",tabindex:"-1","aria-labelledby":"friendsOverlayLabel","aria-hidden":"true"},X={class:"modal-dialog"},Z={class:"modal-content"},ss=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"TagFriendsModalLabel"},"Your friends"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ts={class:"modal-body"},es={class:"list-group"},os={class:"list-group-item bg-light"},as=["value"],ns={class:"modal-footer"},ds=s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},"Confirm",-1),is=s("span",{class:"col-1"},null,-1),ls={class:"modal fade",id:"createPostOverlay",tabindex:"-1","aria-labelledby":"createPostOverlayLabel","aria-hidden":"true"},rs={class:"modal-dialog"},cs={class:"modal-content"},bs=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"ModalLabel"},"Post status"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),us={class:"modal-body"},ms={key:0},hs={key:1},_s=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},"Confirm")],-1);function gs(t,e,o,a,i,n){const b=g("Editor"),l=g("font-awesome-icon");return r(),c("div",V,[s("div",D,[N,u(b,{class:"mb-4",editorStyle:"height: 100px",modelValue:t.content,"onUpdate:modelValue":e[0]||(e[0]=d=>t.content=d)},null,8,["modelValue"]),s("div",F,[B,s("button",L,[u(l,{icon:"fa-solid fa-share"}),m(" Share a badge")]),s("div",S,[s("div",A,[s("div",R,[U,s("div",j,[s("ul",x,[(r(!0),c(p,null,f(t.userBadges,d=>(r(),c("li",M,[s("div",{class:"card col-10 mb-2 ms-4",style:E([t.badge==d.id?"background-color:rgb(175, 209, 191)":""])},[s("img",{class:"card-img-top w-50 mt-3 mx-auto rounded-circle",src:d.image},null,8,Y),s("div",z,[s("div",q,y(d.name),1)])],4),s("div",K,[v(s("input",{type:"radio",name:"badges",value:d.id,"onUpdate:modelValue":e[1]||(e[1]=_=>t.badge=_)},null,8,W),[[I,t.badge]])])]))),256))])]),s("div",G,[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[2]||(e[2]=d=>t.badge="")},"Cancel"),H])])])]),s("button",J,[u(l,{icon:"fa-solid fa-tag"}),m(" Tag a friend")]),s("div",Q,[s("div",X,[s("div",Z,[ss,s("div",ts,[s("ul",es,[(r(!0),c(p,null,f(t.userFriends,d=>(r(),c("li",os,[v(s("input",{type:"checkbox",value:d,"onUpdate:modelValue":e[3]||(e[3]=_=>t.taggedfriends=_),class:"me-2"},null,8,as),[[k,t.taggedfriends]]),m(y(d.handle),1)]))),256))])]),s("div",ns,[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:e[4]||(e[4]=d=>t.taggedfriends=[])},"Cancel"),ds])])])]),s("button",{class:"btn btn-success col-3",type:"button",onClick:e[5]||(e[5]=d=>t.createPost(t.thisuser.email,t.thisuser.handle,t.thisuser.pictureurl)),"data-bs-target":"#createPostOverlay","data-bs-toggle":"modal"},[u(l,{icon:"fa-solid fa-plus-square"}),m(" Create post!")]),is,s("div",ls,[s("div",rs,[s("div",cs,[bs,s("div",us,[t.postStatus?(r(),c("p",ms,"Post created successfully!")):(r(),c("p",hs,"Post creation failed! "))]),_s])])])])])])}const ks=$(T,[["render",gs]]),ps="/assets/fail-9d003f5a.png",fs={name:"FailBackend"},ys={class:"row justify-content-center",style:{"background-color":"#cbdbb7"}},vs=O('<div class="col-12 col-md-6 col-lg-4 mt-3"><div class="card text-center"><div class="card-body"><img class="img-fluid" src="'+ps+'"><h5 class="card-title">Oops!</h5><p class="card-text">We are unable to connect to the backend. Please try again later.</p></div></div></div>',1),$s=[vs];function Cs(t,e,o,a,i,n){return r(),c("div",ys,$s)}const ws=$(fs,[["render",Cs]]);export{ks as C,ws as F};
