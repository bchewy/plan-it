import{C as V}from"./CommunitySidebar-40a6d63f.js";import{N as D}from"./Navbar-faf4802b.js";import{_ as A,u as M,e as p,bs as k,r as I,o as C,c as N,b as _,a as e,y as B,q as O,x as G,i as w,F as P,f as L,v as R,t as K,p as U,h as $}from"./index-0fdca0a9.js";import{a as E}from"./axios-21b846bc.js";import{l as b}from"./index-f203fe86.js";/* empty css              */const Y={data(){return{users:[],badges:[]}},components:{NavBar:D,CommunitySidebar:V},setup(){const{loginWithRedirect:r,user:o,isAuthenticated:T}=M(),t=!1,g=p(""),c=p(null),u=p([]),l=p([]),i=async()=>{const s=`${{}.VITE_API_ENDPOINT}/users/iz/${o.value.email}`,m={"X-Api-Key":`${{}.VITE_API_KEY}`},h=await E.get(s,{headers:m});for(let y of h.data.friends){const v=`${{}.VITE_API_ENDPOINT}/users/iz/${encodeURIComponent(y)}`;try{const n=await E.get(v,{headers:m});l.value.push({handle:"@"+n.data.handle,email:n.data.email})}catch(n){console.error("error",n)}}console.log(l)},a=async(s,m,h,y)=>{const v=`${{}.VITE_API_ENDPOINT}/users/${s}/groups`,n=new FormData;n.append("group_name",m),n.append("group_image",h),n.append("group_members",y);const S=await E.post(v,n,{headers:{"X-Api-Key":`${{}.VITE_API_KEY}`}}),x=S.data;if(S.status===200)return b.success("Group has been successfully created!",{autoClose:5e3,position:b.POSITION.TOP_CENTER}),document.getElementById("createGroupForm").reset(),x;throw new Error(x.message)},f=s=>{c.value=s.target.files[0]},F=async()=>{try{const s=await a(o.value.email,g.value,c.value,u.value)}catch(s){console.error(s.response.data.message),b.error(`${s.response.data.message}`,{autoClose:5e3,position:b.POSITION.TOP_CENTER})}};return k(o,async s=>{s&&await i()},{immediate:!0}),{login:async()=>{console.log("Login button clicked");try{await r()}catch(s){alert("Failed to login"),console.error("Failed to login:",s)}},user:o,isAuthenticated:T,badges:t,groupName:g,groupImage:c,groupMembers:u,friends:l,onFileChange:f,onSubmit:F,createGroup:a,friendList:i}}},d=r=>(U("data-v-76868302"),r=r(),$(),r),j={class:"container-fluid",style:{"background-color":"#cbdbb7"}},q={class:"row justify-content-center"},z={class:"col-10 vh-100"},X=d(()=>e("h2",{class:"text-center py-4 text-colour",style:{"font-weight":"bold"}},"Create your very group!",-1)),W={class:"row justify-content-center"},H={class:"mb-3 mt-3"},J=d(()=>e("label",{for:"grpName",class:"form-label fw-bold"},"Enter your group name:",-1)),Q={class:"mb-3"},Z=d(()=>e("label",{for:"grpImg",class:"form-label fw-bold"},"Select your group profile image:",-1)),ee={class:"mb-3"},oe={class:"btn btn-secondary col",type:"button","data-bs-target":"#friendsOverlay","data-bs-toggle":"modal"},se={class:"modal fade",id:"friendsOverlay",tabindex:"-1","aria-labelledby":"friendsOverlayLabel","aria-hidden":"true"},te={class:"modal-dialog"},ae={class:"modal-content"},ne=d(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"TagFriendsModalLabel"},"Your friends"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),re={class:"modal-body"},le={class:"list-group"},ie={class:"list-group-item bg-light"},de=["value"],ce={class:"modal-footer"},ue=d(()=>e("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},"Confirm",-1)),me={type:"submit",class:"btn btn-success"};function pe(r,o,T,t,g,c){const u=I("NavBar"),l=I("CommunitySidebar"),i=I("font-awesome-icon");return C(),N(P,null,[_(u),_(l),e("div",j,[e("div",q,[e("div",z,[X,e("div",W,[e("form",{class:"col-8 rounded border bg-white p-3",onSubmit:o[4]||(o[4]=B((...a)=>t.onSubmit&&t.onSubmit(...a),["prevent"]))},[e("div",H,[J,O(e("input",{type:"text",class:"form-control",id:"grpName",placeholder:"Group name","onUpdate:modelValue":o[0]||(o[0]=a=>t.groupName=a)},null,512),[[G,t.groupName]])]),e("div",Q,[Z,e("input",{class:"form-control",type:"file",id:"grpImg",onChange:o[1]||(o[1]=(...a)=>t.onFileChange&&t.onFileChange(...a))},null,32)]),e("div",ee,[e("button",oe,[_(i,{icon:"fa-solid fa-plus"}),w(" Select your members!")]),e("div",se,[e("div",te,[e("div",ae,[ne,e("div",re,[e("ul",le,[(C(!0),N(P,null,L(t.friends,a=>(C(),N("li",ie,[O(e("input",{type:"checkbox",value:a.email,"onUpdate:modelValue":o[2]||(o[2]=f=>t.groupMembers=f),class:"me-2"},null,8,de),[[R,t.groupMembers]]),w(K(a.handle),1)]))),256))])]),e("div",ce,[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:o[3]||(o[3]=a=>t.groupMembers=[])},"Cancel"),ue])])])])]),e("button",me,[_(i,{icon:"fa-solid fa-plus-square"}),w(" Create group!")])],32)])])])])],64)}const ve=A(Y,[["render",pe],["__scopeId","data-v-76868302"]]);export{ve as default};
